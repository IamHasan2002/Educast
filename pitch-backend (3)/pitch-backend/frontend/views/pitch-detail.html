<!-- PITCH DETAIL PAGE -->
<div>
  <!-- Loading State -->
  <div ng-if="loading" class="text-center">
    <div class="spinner"></div>
    <p class="loading-text">Loading pitch details...</p>
  </div>

  <!-- Error State -->
  <div ng-if="error && !loading" class="alert alert-error">
    {{ error }}
  </div>

  <!-- Success Message -->
  <div ng-if="successMessage" class="alert alert-success">
    {{ successMessage }}
  </div>

  <!-- Pitch Details -->
  <div ng-if="!loading && pitch" class="main-content">
    <a href="#!/pitches" class="btn btn-secondary mb-3">‚Üê Back to Pitches</a>

    <div class="card">
      <div class="card-header">
        <div>
          <h1 class="card-title">{{ pitch.Pitch }}</h1>
          <p class="card-subtitle">üìç {{ pitch.Ground }}</p>
        </div>
        <span class="badge" ng-class="getStatusBadgeClass(pitch.Status)">{{ pitch.Status }}</span>
      </div>

      <div class="grid grid-2">
        <div>
          <h3 class="text-primary">Pitch Information</h3>
          <p><strong>Environment:</strong> {{ pitch.Environment }}</p>
          <p><strong>Ground Type:</strong> {{ pitch.GroundType }}</p>
          <p><strong>Price:</strong> <span class="text-primary" style="font-size: 1.5rem; font-weight: bold;">¬£{{ pitch.PitchPrice }}</span></p>
          <p><strong>Bowling Machine:</strong> <span class="badge" ng-class="pitch['Bowling Machine'] === 'available' ? 'badge-open' : 'badge-closed'">{{ pitch['Bowling Machine'] }}</span></p>
        </div>

        <div>
          <h3 class="text-primary">Location</h3>
          <p><strong>Latitude:</strong> {{ pitch.location.latitude }}</p>
          <p><strong>Longitude:</strong> {{ pitch.location.longitude }}</p>
          <p style="margin-top: 1rem; font-size: 0.9rem; color: #666;">
            üìç Open in <a href="https://maps.google.com/?q={{ pitch.location.latitude }},{{ pitch.location.longitude }}" target="_blank" style="color: var(--primary-red);">Google Maps</a>
          </p>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="card mt-3" style="padding: 1rem;">
      <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
        <a href="#!/pitches" class="btn btn-secondary">‚Üê Back to Pitches</a>
        <button ng-if="isOwner()" ng-click="goToEdit()" class="btn btn-primary">‚úèÔ∏è Edit Pitch</button>
        <button ng-if="isOwner()" ng-click="deletePitch()" class="btn btn-danger" ng-disabled="deleting">
          {{ deleting ? 'Deleting...' : 'üóëÔ∏è Delete Pitch' }}
        </button>
      </div>
    </div>

    <!-- Reviews Section -->
    <div class="card mt-3">
      <h3 class="text-primary mb-2">Reviews ({{ pitch.Reviews.length }})</h3>

      <div ng-if="pitch.Reviews.length > 0">
        <div ng-repeat="review in pitch.Reviews" class="review-item">
          <div class="review-header">
            <span class="review-author">{{ review.reviewer }}</span>
            <span class="review-rating">{{ getStars(review.rating) }} ({{ review.rating }}/5)</span>
          </div>
          <p>{{ review.comment }}</p>
        </div>
      </div>

      <div ng-if="pitch.Reviews.length === 0" class="text-center" style="padding: 1rem;">
        <p style="color: #666;">No reviews yet. Be the first to leave a review!</p>
      </div>
    </div>

    <!-- Add Review Section -->
    <div class="card mt-3">
      <h3 class="text-primary mb-2">Leave a Review</h3>
      <form ng-submit="addReview()" style="display: flex; flex-direction: column; gap: 1rem;">
        <div class="form-group">
          <label for="reviewer">Your Name</label>
          <input type="text" id="reviewer" ng-model="review.reviewer" placeholder="Your name" required>
        </div>

        <div class="form-group">
          <label for="rating">Rating (1-5)</label>
          <select id="rating" ng-model="review.rating" required>
            <option value="1">1 - Poor</option>
            <option value="2">2 - Fair</option>
            <option value="3">3 - Good</option>
            <option value="4">4 - Very Good</option>
            <option value="5">5 - Excellent</option>
          </select>
        </div>

        <div class="form-group">
          <label for="comment">Your Comment</label>
          <textarea id="comment" ng-model="review.comment" placeholder="Share your experience..." required></textarea>
        </div>

        <button type="submit" class="btn btn-primary">Submit Review</button>
      </form>
    </div>
  </div>
</div>
